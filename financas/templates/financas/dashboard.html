{% extends "base.html" %}
{% block title %}Dashboard - Ordo{% endblock %}
{% block content %}

<!-- Header -->
<div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 animate-fade-in">
    <div class="mb-4 sm:mb-0">
        <h1 class="text-3xl sm:text-4xl font-bold text-dark-800 mb-2">
            Ol√°, {{ user.username }}! üëã
        </h1>
        <p class="text-dark-500 text-lg">Aqui est√° seu resumo financeiro de hoje</p>
    </div>
    
    <!-- Link para adicionar transa√ß√£o -->
    <a href="{% url 'adicionar_transacao' %}"
        class="group bg-primary-500 hover:bg-primary-600 text-white font-semibold px-6 py-3 rounded-xl transition-all duration-300 flex items-center space-x-2 shadow-lg hover:shadow-xl transform hover:scale-105">
        <i data-lucide="plus" class="w-5 h-5 group-hover:rotate-90 transition-transform duration-300"></i>
        <span>Novo Lan√ßamento</span>
    </a>
</div>

<!-- CARDS DE DADOS -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
    
    <!-- Card 1: Receitas -->
    <div class="income-gradient rounded-2xl p-6 text-white card-hover animate-slide-up shadow-lg">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <i data-lucide="trending-up" class="w-6 h-6"></i>
            </div>
            <span class="text-sm font-medium opacity-90">Este m√™s</span>
        </div>
        <div>
            <p class="text-sm opacity-90 mb-1">Receitas</p>
            <p class="text-2xl sm:text-3xl font-bold">R$ {{ receitas_mes|floatformat:2 }}</p>
            <div class="flex items-center mt-2 text-sm">
                <i data-lucide="arrow-up" class="w-4 h-4 mr-1"></i>
                <span>Entradas do m√™s</span>
            </div>
        </div>
    </div>

    <!-- Card 2: Despesas -->
    <div class="expense-gradient rounded-2xl p-6 text-white card-hover animate-slide-up shadow-lg" style="animation-delay: 0.1s;">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <i data-lucide="trending-down" class="w-6 h-6"></i>
            </div>
            <span class="text-sm font-medium opacity-90">Este m√™s</span>
        </div>
        <div>
            <p class="text-sm opacity-90 mb-1">Despesas</p>
            <p class="text-2xl sm:text-3xl font-bold">R$ {{ despesas_mes|floatformat:2 }}</p>
            <div class="flex items-center mt-2 text-sm">
                <i data-lucide="arrow-down" class="w-4 h-4 mr-1"></i>
                <span>Sa√≠das do m√™s</span>
            </div>
        </div>
    </div>

    <!-- Card 3: Saldo Total -->
    <div class="balance-gradient rounded-2xl p-6 text-white card-hover animate-slide-up shadow-lg" style="animation-delay: 0.2s;">
        <div class="flex items-center justify-between mb-4">
            <div class="w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center">
                <i data-lucide="wallet" class="w-6 h-6"></i>
            </div>
            <span class="text-sm font-medium opacity-90">Saldo atual</span>
        </div>
        <div>
            <p class="text-sm opacity-90 mb-1">Saldo Total</p>
            <p class="text-2xl sm:text-3xl font-bold">R$ {{ saldo_total|floatformat:2 }}</p>
            <div class="flex items-center mt-2 text-sm">
                <i data-lucide="{% if saldo_total >= 0 %}shield-check{% else %}alert-triangle{% endif %}" class="w-4 h-4 mr-1"></i>
                <span>{% if saldo_total >= 0 %}Saldo positivo{% else %}Aten√ß√£o ao saldo{% endif %}</span>
            </div>
        </div>
    </div>
</div>

<!-- Card de Lan√ßamentos Recentes -->
<div class="bg-white rounded-2xl shadow-lg border border-gray-100 animate-fade-in" style="animation-delay: 0.3s;">
    <div class="p-6 border-b border-gray-100">
        <div class="flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="w-10 h-10 bg-primary-100 rounded-xl flex items-center justify-center">
                    <i data-lucide="activity" class="w-5 h-5 text-primary-600"></i>
                </div>
                <h2 class="text-xl font-bold text-dark-800">Lan√ßamentos Recentes</h2>
            </div>
            <a href="{% url 'lista_transacoes' %}" 
               class="text-primary-600 hover:text-primary-700 font-medium flex items-center space-x-1 transition-colors">
                <span>Ver todos</span>
                <i data-lucide="arrow-right" class="w-4 h-4"></i>
            </a>
        </div>
    </div>
    
    <div class="p-6">
        {% if ultimos_lancamentos %}
        <div class="space-y-4">
            {% for lancamento in ultimos_lancamentos %}
            <div class="flex items-center justify-between p-4 rounded-xl hover:bg-gray-50 transition-colors group">
                <div class="flex items-center space-x-4">
                    <div class="w-12 h-12 {% if lancamento.tipo == 'RECEITA' %}bg-green-100{% else %}bg-red-100{% endif %} rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform">
                        {% if lancamento.tipo == 'RECEITA' %}
                            <i data-lucide="arrow-down-left" class="w-6 h-6 text-green-600"></i>
                        {% else %}
                            <i data-lucide="arrow-up-right" class="w-6 h-6 text-red-600"></i>
                        {% endif %}
                    </div>
                    <div>
                        <p class="font-semibold text-dark-800">{{ lancamento.descricao }}</p>
                        <div class="flex items-center space-x-3 text-sm text-dark-500">
                            <span>{{ lancamento.data|date:"d/m/Y" }}</span>
                            {% if lancamento.categoria %}
                            <span>‚Ä¢</span>
                            <span class="px-2 py-1 {% if lancamento.tipo == 'RECEITA' %}bg-green-100 text-green-700{% else %}bg-red-100 text-red-700{% endif %} rounded-full text-xs font-medium">
                                {{ lancamento.categoria.nome }}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                </div>
                <div class="text-right">
                    <p class="text-lg font-bold {% if lancamento.tipo == 'RECEITA' %}text-green-600{% else %}text-red-600{% endif %}">
                        {% if lancamento.tipo == 'DESPESA' %}- {% else %}+ {% endif %}R$ {{ lancamento.valor|floatformat:2 }}
                    </p>
                    <p class="text-sm text-dark-400">
                        {{ lancamento.data|date:"l" }}
                    </p>
                </div>
            </div>
            {% endfor %}
        </div>
        {% else %}
        <div class="text-center py-12">
            <div class="w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4">
                <i data-lucide="receipt" class="w-8 h-8 text-gray-400"></i>
            </div>
            <h3 class="text-lg font-semibold text-dark-700 mb-2">Nenhum lan√ßamento ainda</h3>
            <p class="text-dark-500 mb-6">Comece adicionando sua primeira transa√ß√£o</p>
            <a href="{% url 'adicionar_transacao' %}"
               class="inline-flex items-center space-x-2 bg-primary-500 hover:bg-primary-600 text-white font-medium px-4 py-2 rounded-lg transition-colors">
                <i data-lucide="plus" class="w-4 h-4"></i>
                <span>Adicionar Lan√ßamento</span>
            </a>
        </div>
        {% endif %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Initialize Lucide icons after content loads
    lucide.createIcons();
    
    // Add some interactive effects
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    });

    document.querySelectorAll('.card-hover').forEach(card => {
        observer.observe(card);
    });
});
</script>

{% endblock %}